@using com.Sconit.Entity.MRP.MD
@using com.Sconit.Web.Models.SearchModels.MRP

<fieldset>
    @using (Html.BeginForm("InstanceList", "Machine"))
    {   
        <div class="search">
            <div class="search-label">
                <label>
                    @Resources.MRP.MachineInstance.MachineInstance_DateType
                </label>
            </div>
            <div class="search-field">
                @{
        Html.RenderAction("_CodeMasterComboBox", "Common", new
        {
            code = com.Sconit.CodeMaster.CodeMaster.TimeUnit,
            includeBlankOption = true,
            isMrp = true,
            isChange = true,
            controlName = "DateType",
            selectedValue = TempData["MachineInstanceSearchModel"] != null ? ((MachineInstanceSearchModel)TempData["MachineInstanceSearchModel"]).DateType : -1
        });
                }
            </div>

            <div class="search-label">
                <label>
                    @Resources.MRP.MachineInstance.MachineInstance_Region
                </label>
            </div>
            <div class="search-field">
                @{
        Html.RenderAction("_RegionComboBox", "Common",
            new
            {
                controlName = "Region",
                selectedValue = TempData["MachineInstanceSearchModel"] != null ? ((MachineInstanceSearchModel)TempData["MachineInstanceSearchModel"]).Region : string.Empty
            });
                }
            </div>

            @{
        if (ViewBag.DateType != "4" || ViewBag.DateType == null)
        {
                <div class="search-label" id="Dateindexlabel">
                    <label>
                        @Resources.MRP.MachineInstance.MachineInstance_DateIndex
                    </label>
                </div>
                <div class="search-field" id="Dateindexfield">
                    @{
            Html.RenderAction("_DateIndexComboBox", "Common", new
            {
                includeBlankOption = true,
                controlName = "DateIndex",
                selectedValue = TempData["MachineInstanceSearchModel"] != null ? ((MachineInstanceSearchModel)TempData["MachineInstanceSearchModel"]).DateIndex : string.Empty
            });
                    }
                </div>
                <div class="search-label" id="DateindexTolabel">
                    <label>
                        @Resources.MRP.MachineInstance.MachineInstance_DateIndexTo
                    </label>
                </div>
                <div class="search-field" id="DateindexTofield">
                    @{
            Html.RenderAction("_DateIndexComboBox", "Common", new
            {
                includeBlankOption = true,
                controlName = "DateIndexTo",
                selectedValue = TempData["MachineInstanceSearchModel"] != null ? ((MachineInstanceSearchModel)TempData["MachineInstanceSearchModel"]).DateIndexTo : string.Empty
            });
                    }
                </div>


                <div class="search-label" id="DateIndexDatelabel" style="display: none">
                    <label>
                        @Resources.MRP.MachineInstance.MachineInstance_DateIndex
                    </label>
                </div>
                <div class="search-field" id="DateIndexDatefield" style="display: none">
                    @(Html.Telerik().DatePicker().Name("DateIndexDate")
            .Value(TempData["MachineInstanceSearchModel"] != null ? ((MachineInstanceSearchModel)TempData["MachineInstanceSearchModel"]).DateIndexDate : System.DateTime.Today).Min(System.DateTime.Today)
                .HtmlAttributes(new { style = "margin-bottom: 1.3em;width:200px" }))
                </div>

                <div class="search-label" id="DateindexToDatelabel" style="display: none">
                    <label>
                        @Resources.MRP.MachineInstance.MachineInstance_DateIndexTo
                    </label>
                </div>
                <div class="search-field" id="DateIndexToDatefield" style="display: none">
                    @(Html.Telerik().DatePicker().Name("DateIndexToDate")
            .Value(TempData["MachineInstanceSearchModel"] != null ? ((MachineInstanceSearchModel)TempData["MachineInstanceSearchModel"]).DateIndexToDate : System.DateTime.Today.AddDays(14)).Min(System.DateTime.Today)
                .HtmlAttributes(new { style = "margin-bottom: 1.3em;width:200px" }))
                </div>
        }
        else
        {
                <div class="search-label" id="Dateindexlabel" style="display: none">
                    <label>
                        @Resources.MRP.MachineInstance.MachineInstance_DateIndex
                    </label>
                </div>
                <div class="search-field" id="Dateindexfield" style="display: none">
                    @{
            Html.RenderAction("_DateIndexComboBox", "Common", new
            {
                includeBlankOption = true,
                controlName = "DateIndex",
                selectedValue = TempData["MachineInstanceSearchModel"] != null ? ((MachineInstanceSearchModel)TempData["MachineInstanceSearchModel"]).DateIndex : string.Empty
            });
                    }
                </div>
                <div class="search-label" id="DateindexTolabel" style="display: none">
                    <label>
                        @Resources.MRP.MachineInstance.MachineInstance_DateIndexTo
                    </label>
                </div>
                <div class="search-field" id="DateindexTofield" style="display: none">
                    @{
            Html.RenderAction("_DateIndexComboBox", "Common", new
            {
                includeBlankOption = true,
                controlName = "DateIndexTo",
                selectedValue = TempData["MachineInstanceSearchModel"] != null ? ((MachineInstanceSearchModel)TempData["MachineInstanceSearchModel"]).DateIndexTo : string.Empty
            });
                    }
                </div>


                <div class="search-label" id="DateIndexDatelabel">
                    <label>
                        @Resources.MRP.MachineInstance.MachineInstance_DateIndex
                    </label>
                </div>
                <div class="search-field" id="DateIndexDatefield">
                    @(Html.Telerik().DatePicker().Name("DateIndexDate")
         .Value(TempData["MachineInstanceSearchModel"] != null ? ((MachineInstanceSearchModel)TempData["MachineInstanceSearchModel"]).DateIndexDate : System.DateTime.Today).Min(System.DateTime.Today)
                .HtmlAttributes(new { style = "margin-bottom: 1.3em;width:200px" }))
                </div>

                <div class="search-label" id="DateindexToDatelabel">
                    <label>
                        @Resources.MRP.MachineInstance.MachineInstance_DateIndexTo
                    </label>
                </div>
                <div class="search-field" id="DateIndexToDatefield">
                    @(Html.Telerik().DatePicker().Name("DateIndexToDate")
          .Value(TempData["MachineInstanceSearchModel"] != null ? ((MachineInstanceSearchModel)TempData["MachineInstanceSearchModel"]).DateIndexToDate : System.DateTime.Today.AddDays(14)).Min(System.DateTime.Today)
                .HtmlAttributes(new { style = "margin-bottom: 1.3em;width:200px" }))
                </div>
        }
               
            }

            <div class="search-label">
                <label>
                    @Resources.MRP.MachineInstance.MachineInstance_Code
                </label>
            </div>
            <div class="search-field">
                @{
        Html.RenderAction("_MachineComboBox", "Common",
            new
            {
                controlName = "Code",
                selectedValue = TempData["MachineInstanceSearchModel"] != null ? ((MachineInstanceSearchModel)TempData["MachineInstanceSearchModel"]).Code : string.Empty
            });
                }
            </div>
            <div class="search-label">
                <label>
                    @Resources.MRP.MachineInstance.MachineInstance_ShiftType
                </label>
            </div>
            <div class="search-field">
                @{
        Html.RenderAction("_CodeMasterDropDownList", "Common", new
        {
            code = com.Sconit.CodeMaster.CodeMaster.ShiftType,
            includeBlankOption = true,
            controlName = "ShiftType",
            selectedValue = TempData["MachineInstanceSearchModel"] != null ? ((MachineInstanceSearchModel)TempData["MachineInstanceSearchModel"]).ShiftType : -1
        });
                }
            </div>
            <div class="search-label">
                <label>
                    @Resources.MRP.MachineInstance.MachineInstance_MachineType
                </label>
            </div>
            <div class="search-field">
                @{
        Html.RenderAction("_CodeMasterDropDownList", "Common", new
        {
            code = com.Sconit.CodeMaster.CodeMaster.MachineType,
            includeBlankOption = true,
            controlName = "MachineType",
            selectedValue = TempData["MachineInstanceSearchModel"] != null ? ((MachineInstanceSearchModel)TempData["MachineInstanceSearchModel"]).MachineType : -1
        });
                }
            </div>
        </div>
        <div class="search-footer">
            @Html.Hidden("isFromList", true)
            <button type="submit" id="btnSearch">
                @Resources.SYS.Global.Button_Search</button>
            @Html.Button(Resources.SYS.Global.Button_New, "Url_MRP_MachineInstance_View", new Dictionary<string, string>()
	    {
	        {"type", "button"},
	        {"id", "btnNew"},
            {"onclick","location.href='"+@Url.Content("~/Machine/InstanceNew")+"'"}
	    })
            <button type="button" id="btnExport" onclick="ExportClick()">@Resources.SYS.Global.Button_Export</button>
        </div>

    }
</fieldset>

<script type="text/javascript">
    function CodeMaster_Change(e) {
        if (e.value == 4) {
            document.getElementById("Dateindexlabel").style.display = 'none';
            document.getElementById("Dateindexfield").style.display = 'none';
            document.getElementById("DateindexTolabel").style.display = 'none';
            document.getElementById("DateindexTofield").style.display = 'none';
            document.getElementById("DateIndexDatelabel").style.display = 'inline';
            document.getElementById("DateIndexDatefield").style.display = 'inline';
            document.getElementById("DateindexToDatelabel").style.display = 'inline';
            document.getElementById("DateIndexToDatefield").style.display = 'inline';

        }
        else {
            document.getElementById("Dateindexlabel").style.display = 'inline';
            document.getElementById("Dateindexfield").style.display = 'inline';
            document.getElementById("DateindexTolabel").style.display = 'inline';
            document.getElementById("DateindexTofield").style.display = 'inline';
            document.getElementById("DateIndexDatelabel").style.display = 'none';
            document.getElementById("DateIndexDatefield").style.display = 'none';
            document.getElementById("DateindexToDatelabel").style.display = 'none';
            document.getElementById("DateIndexToDatefield").style.display = 'none';
            $('#DateIndex').data('tComboBox').value('');
            $('#DateIndex').data('tComboBox').text('');
            $("#DateIndex").data("tComboBox").reload();
            $('#DateIndexTo').data('tComboBox').value('');
            $('#DateIndexTo').data('tComboBox').text('');
            $("#DateIndexTo").data("tComboBox").reload();
        }

    }

    function DateIndex_DataBinding(e) {
        if ($('#DateType').val() != 4) {
            e.data = {
                dateType: $('#DateType').val()
            }
        }

    }
    function ExportClick() {
        
        location.href = '/Machine/ExportXLS/?Region=' + $('#Region').val() + '&Code=' + $('#Code').val()
            + '&DateType=' + $('#DateType').val() + '&ShiftType=' + $('#ShiftType').val() + '&DateIndex=' + $('#DateIndex').val()
            + '&DateIndexTo=' + $('#DateIndexTo').val() + '&DateIndexDate=' + $('#DateIndexDate').val() 
            + '&DateIndexToDate=' + $('#DateIndexToDate').val()
     
    }
</script>
